#! /usr/bin/env bash

declare cmd_name=$1

# command args
declare argv=${@:2}


# command should be provied other wise quit
if [[ -z $cmd_name ]]
then
	echo "Command: ${cmd_name} not found..."
	exit 1
fi


# source files global files
declare -a main_partials=( "helper" "profile" "cleanup" )
declare partials_bname=$(dirname $0)

for _filename in ${main_partials[@]}
do

	declare resolved_pathname="${partials_bname}/g.${_filename}"

	if [[ ! -f $resolved_pathname ]]
	then
		 echo "Failed to open file at: \"$resolved_pathname\""
		 exit 1
	fi

	# source file if exists
	source $resolved_pathname

done

declare exec_pathname="${scripts_path}/commands/${cmd_name}/.exec"

if [[ ! -f $exec_pathname ]]
then
	echo "Failed to execute Sub Command: \$\"${cmd_name}\""
	exit 1
fi

# execute command `.exec` file
bash $exec_pathname $argv
